{{- $server   := false -}}
{{- $headless := false -}}
{{- $mobile   := false -}}
{{- $termux   := false -}}
{{- $windows  := false -}}
{{- $darwin   := false -}}
{{- $linux    := false -}}
{{- $headful  := false -}}
{{- "" -}}

{{- if eq .chezmoi.os "linux" -}}
{{-   $linux = true -}}
{{-   if or (eq (env "XDG_SESSION_TYPE") "tty" "") (ne (env "SSH_TTY") "") -}}
{{-     $server = true   -}}
{{-     $headless = true -}}
{{-   end -}}
{{- else if eq .chezmoi.os "windows" -}}
{{-   $windows = true -}}
{{- else if eq .chezmoi.os "darwin" -}}
{{-   $darwin = true -}}
{{- else if eq .chezmoi.os "android" -}}
{{-   $mobile = true -}}
{{-   $termux = true -}}
{{-   $linux  = true -}}
{{- end -}}

{{- $usr_prefix := "/usr" }}


[data]
    # Autogenerated to derive variables, do not edit. os='{{ .chezmoi.os }}', $OSTYPE='{{ env "OSTYPE" }}', $HOME='{{ env "HOME" }}'.
    server   = {{ $server }}
    headless = {{ $headless }}
    headful  = {{ not $headless }}
    mobile   = {{ $mobile }}

    termux   = {{ $termux }}
    windows  = {{ $windows }}
    linux    = {{ $linux }}
    darwin   = {{ $darwin }}
    cygwin   = {{ $windows }}

    usr_prefix = {{ if $termux }}{{ env "PREFIX" }}{{else}}"/usr"{{ end }}

{{- /* Максимально непортабельно -- исключительно под мои личные компьютеры */}}
[data.dpi]
    normal = "normal"
    high   = "high"
    retina = "retina"
    level = {{ if $darwin }}"retina"{{ else if $windows }}"normal"{{ else }}"high"{{ end }}

[data.style]
{{- /* [ "ss16" ] -- стиль PT Mono, [ "cv86" ] а где-то [ "cv88" ] -- плоская троечка */}}
{{- if $windows }}
    fav_font_full_name = "Iosevka Term"
    fav_font_name = "IosevkaTerm NFM"
    fav_font_name_nf = "IosevkaTerm NFM"
    fav_font_name_nf_mono = "IosevkaTerm NFM"
    fav_font_psname = "Iosevka-Term-NFM"
    fav_font_psname_nf = "Iosevka-Term-NFM"
    fav_font_variants = [ "cv88" ]
{{- else if $darwin }}
    fav_font_full_name = "Iosevka Term"
    fav_font_name = "Iosevka Term"
    fav_font_name_nf = "IosevkaTerm Nerd Font"
    fav_font_name_nf_mono = "IosevkaTerm Nerd Font Mono"
    fav_font_psname = "Iosevka-Term"
    fav_font_psname_nf = "IosevkaTermNF"
    fav_font_variants = [ "cv88" ]
{{- else }}{{- /* Linux */}}
    fav_font_full_name = "Iosevka Term"
    fav_font_name = "IosevkaTerm"
    fav_font_name_nf = "IosevkaTerm NF"
    fav_font_name_nf_mono = "IosevkaTerm NFM"
    fav_font_psname = "Iosevka-Term"
    fav_font_psname_nf = "IosevkaTermNF"
    fav_font_variants = [ "cv88" ]
{{- end }}

{{- if or $headless $termux }}
[diff]
    command = "nvim"
    args = ["-d",     "{{ "{{" }} .Destination {{ "}}" }}",                                  "{{ "{{" }} .Target {{ "}}" }}"]
[merge]
    command = "nvim"
    args = ["-d",     "{{ "{{" }} .Destination {{ "}}" }}", "{{ "{{" }} .Source {{ "}}" }}", "{{ "{{" }} .Target {{ "}}" }}"]
{{- else }}
[diff]
    command = "meld"
    args = ["--diff", "{{ "{{" }} .Destination {{ "}}" }}",                                  "{{ "{{" }} .Target {{ "}}" }}"]
[merge]
    command = "meld"
    args = [          "{{ "{{" }} .Destination {{ "}}" }}", "{{ "{{" }} .Source {{ "}}" }}", "{{ "{{" }} .Target {{ "}}" }}"]
{{- end }}
